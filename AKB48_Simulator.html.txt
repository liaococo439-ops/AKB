<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AKB48 æ¨¡æ‹Ÿå™¨ - ç»ˆæè¿è¥ç‰ˆ v2.0</title>
    <style>
        :root {
            --akb-pink: #e91e63;
            --akb-light: #fce4ec;
            --team-a: #ff0000;
            --team-k: #00ff00;
            --team-b: #0000ff;
            --guts-color: #ff9800;
            --janken-gold: #ffd700;
        }

        body { font-family: 'Segoe UI', "Microsoft YaHei", sans-serif; background: #fdf2f5; margin: 0; color: #2c3e50; display: flex; justify-content: center; }
        .container { width: 100%; max-width: 1200px; background: white; min-height: 100vh; box-shadow: 0 0 20px rgba(0,0,0,0.05); display: flex; flex-direction: column; }
        header { background: var(--akb-pink); color: white; padding: 15px; text-align: center; }

        /* å±æ€§ä¸ä»ªè¡¨ç›˜ */
        .status-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; padding: 15px; background: #fff; border-bottom: 2px solid var(--akb-pink); }
        .status-card { background: var(--akb-light); padding: 10px; border-radius: 8px; border: 1px solid #f8bbd0; text-align: center; }
        .status-label { font-size: 11px; color: #880e4f; font-weight: bold; }
        .status-value { font-size: 18px; font-weight: bold; color: var(--akb-pink); display: block; }

        /* å¸ƒå±€ */
        .game-grid { display: grid; grid-template-columns: 280px 1fr 320px; gap: 15px; padding: 15px; flex-grow: 1; }
        
        /* åŠ¨æ€æˆå‘˜åˆ—è¡¨ */
        .panel { background: #fcfcfc; border: 1px solid #eee; border-radius: 10px; padding: 12px; }
        .member-item { background: white; padding: 8px; border-radius: 5px; margin-bottom: 8px; border-left: 5px solid #ccc; font-size: 13px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }

        /* æ—¥å¿— */
        .log-container { background: #1a1a1a; border-radius: 10px; padding: 12px; color: #00ff41; height: 500px; overflow-y: auto; font-size: 13px; font-family: 'Consolas', monospace; display: flex; flex-direction: column-reverse; }
        .log-entry { margin-bottom: 6px; border-bottom: 1px dotted #333; padding-bottom: 4px; }
        .tag { padding: 1px 4px; border-radius: 3px; font-size: 10px; color: white; margin-right: 5px; }

        /* æ“ä½œæŒ‰é’® */
        .btn { border: none; padding: 12px; border-radius: 6px; font-weight: bold; cursor: pointer; transition: 0.2s; width: 100%; margin-bottom: 8px; }
        .btn-main { background: var(--akb-pink); color: white; font-size: 16px; }
        .btn-janken { background: var(--janken-gold); color: #333; animation: pulse 1.5s infinite; }
        .btn-action { background: #fff; color: var(--akb-pink); border: 1px solid var(--akb-pink); }
        .btn-action:hover { background: var(--akb-light); }

        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.7; } 100% { opacity: 1; } }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1 style="margin:0;">AKB48 æ¨¡æ‹Ÿå™¨ - ç»ˆæè¿è¥ç‰ˆ</h1>
        <div id="game-info">æ­£åœ¨è½½å…¥ç§‹å¶åŸå‰§åœº...</div>
    </header>

    <div class="status-container" id="status-board"></div>

    <div class="game-grid">
        <aside class="panel">
            <h3 style="color: var(--akb-pink); margin-top: 0;">æ‰€å±å›¢é˜Ÿä¸å…³ç³»</h3>
            <div id="team-info" style="font-weight: bold; margin-bottom: 10px;"></div>
            <div id="bond-list"></div>
        </aside>

        <main class="log-container" id="log-display"></main>

        <aside class="panel">
            <button class="btn btn-main" onclick="nextQuarter()">æ¨è¿›å­£åº¦ (å•æ›²å‘å¸ƒ)</button>
            <button class="btn btn-janken" id="janken-btn" style="display:none;" onclick="startJanken()">âœŠ å‚åŠ çŒœæ‹³å¤§ä¼š!</button>
            
            <div style="margin-top:15px; border-top: 1px solid #ddd; padding-top: 10px;">
                <p style="font-size: 12px; color: #666;">å­£é—´è¡ŒåŠ¨ (å‰©ä½™: <span id="acts">3</span>)</p>
                <button class="btn btn-action" onclick="playAction('work')">ğŸ¤ å¤–åŠ¡/æ¡æ‰‹ä¼š</button>
                <button class="btn btn-action" onclick="playAction('lesson')">ğŸ’ƒ ç–¯ç‹‚ç»ƒä¹ </button>
                <button class="btn btn-action" onclick="playAction('variety')">ğŸ“º å½•åˆ¶ AKBINGO</button>
                <button class="btn btn-action" onclick="playAction('bond')">â˜• é˜Ÿå‹ç§è”/èšé¤</button>
            </div>
            
            <button class="btn" style="background:#eee; color:#666; font-size:11px;" onclick="requestGraduation()">ğŸŒ¸ ç”³è¯·æ¯•ä¸š</button>
        </aside>
    </div>
</div>

<script>
    // --- æ•°æ®åˆå§‹åŒ– ---
    let state = {
        player: {
            name: "ä¸»æ§", gen: 15, team: "Team A", status: "æ­£å¼æˆå‘˜",
            stats: { visual: 60, perf: 50, variety: 40, popularity: 200, stamina: 100, mood: 100, guts: 60, love: 30 },
            isGraduated: false, rank: "åœˆå¤–"
        },
        bonds: [
            { name: "é«˜æ¡¥å—", value: 50, type: "å‰è¾ˆ" },
            { name: "å‰ç”°æ•¦å­", value: 40, type: "å¯¹æ‰‹" },
            { name: "æ¨ªå±±ç”±ä¾", value: 60, type: "äº²å‹" }
        ],
        time: { year: 1, quarter: 1 },
        acts: 3,
        jankenEvent: false
    };

    function init() {
        addLog("ã€ç³»ç»Ÿã€‘æ¬¢è¿æ¥åˆ° 48 é›†å›¢ï¼ä½ ç°åœ¨çš„èº«ä»½æ˜¯æ­£å¼æˆå‘˜ã€‚", "#7f8c8d");
        updateUI();
    }

    // --- æ ¸å¿ƒè¡ŒåŠ¨é€»è¾‘ ---
    function playAction(type) {
        if(state.acts <= 0 || state.player.isGraduated) return;
        const p = state.player;
        state.acts--;

        switch(type) {
            case 'work':
                let pGain = Math.floor((Math.random()*50 + 10) * (p.stats.guts/50));
                p.stats.popularity += pGain;
                p.stats.stamina -= 20;
                addLog(`åœ¨æ¡æ‰‹ä¼šè¡¨ç°å‡ºè‰²ï¼Œç²‰ä¸å¢åŠ  ${pGain}ã€‚`);
                break;
            case 'lesson':
                p.stats.perf += Math.floor(6 * (1 + p.stats.guts/100));
                p.stats.stamina -= 25;
                p.stats.guts += 5;
                addLog(`ç»ƒä¹ å®¤çš„æ±—æ°´ä¸ä¼šç™½æµï¼Œè¡¨ç°åŠ›æå‡ï¼`);
                break;
            case 'variety':
                p.stats.variety += 8;
                p.stats.stamina -= 15;
                addLog(`åœ¨ç»¼è‰ºé‡Œè¢«å¥¶æ²¹ç‚®å‡»ä¸­ï¼Œç»¼è‰ºæ„Ÿæå‡ã€‚`);
                break;
            case 'bond':
                state.bonds.forEach(b => b.value += 5);
                p.stats.mood += 15;
                addLog(`ä¸é˜Ÿå‹ä»¬èšé¤ï¼Œå›¢é˜Ÿç¾ç»ŠåŠ æ·±ã€‚`);
                break;
        }
        updateUI();
    }

    // --- å­£åº¦ä¸é€‰æ‹”é€»è¾‘ ---
    function nextQuarter() {
        if(state.player.isGraduated) return;
        const p = state.player;
        const q = state.time.quarter;
        
        addLog(`--- ç¬¬ ${state.time.year} å¹´ Q${q} é€‰æ‹”åå•å…¬å¸ƒ ---`, "#e91e63");

        // é€‰æ‹”ç®—æ³•
        let score = (p.stats.visual * 0.3) + (p.stats.love * 0.4) + (p.stats.perf * 0.3);
        if (q === 3) score = p.stats.popularity / 10; // æ€»é€‰å•

        if (score > 95) {
            p.rank = "CENTER"; p.stats.popularity += 1500; p.stats.love += 15;
            addLog("ğŸŒŸã€å¤§æ–°é—»ã€‘ä½ æˆä¸ºäº†æœ¬æ¬¡å•æ›²çš„ç»å¯¹ Centerï¼");
        } else if (score > 60) {
            p.rank = "é€‰æ‹”ç»„"; p.stats.popularity += 500;
            addLog("âœ… ä½ é¡ºåˆ©è¿›å…¥é€‰æ‹”åå•ï¼Œæ‹æ‘„äº†å°é¢ã€‚");
        } else {
            p.rank = "åœˆå¤–"; p.stats.mood -= 20; p.stats.guts -= 5;
            addLog("âŒ è½é€‰äº†...åœ¨å‰§åœºç»§ç»­ç£¨ç»ƒå§ã€‚");
            // ç§»ç±/é™æ ¼åˆ¤å®šï¼šå¦‚æœè¿è¥çˆ±å¤ªä½ä¸”é•¿æœŸåœˆå¤–
            if(p.stats.love < 10 && Math.random() < 0.2) triggerShuffle();
        }

        // æ—¶é—´æ›´æ–°
        if(state.time.quarter < 4) state.time.quarter++;
        else { state.time.quarter = 1; state.time.year++; }

        // éšæœºè§¦å‘çŒœæ‹³å¤§ä¼š
        state.jankenEvent = (Math.random() < 0.15);
        if(state.jankenEvent) addLog("ğŸ†ã€ç´§æ€¥ã€‘æ­¦é“é¦†çŒœæ‹³å¤§ä¼šå³å°†å¬å¼€ï¼", "#ffd700");

        state.acts = 3;
        p.stats.stamina = Math.max(10, p.stats.stamina - 20);
        updateUI();
    }

    // --- çŒœæ‹³å¤§ä¼š (è¿æ°”ç³»ç»Ÿ) ---
    function startJanken() {
        addLog("âœŠ çŒœæ‹³å¤§ä¼šå¼€å§‹ï¼å…¨æ—¥æœ¬éƒ½åœ¨å…³æ³¨...", "#ffd700");
        let rounds = 4;
        let win = true;
        for(let i=0; i<rounds; i++) {
            if(Math.random() < 0.5) { win = false; break; }
        }

        if(win) {
            state.player.rank = "çŒœæ‹³Center";
            state.player.stats.popularity += 3000;
            state.player.stats.love += 50;
            addLog("ğŸŠã€å¥‡è¿¹ã€‘ä½ ç«Ÿç„¶ä¸€è·¯è¿èƒœèµ¢å¾—äº†å† å†›ï¼Center è¾¾æˆï¼", "#ffd700");
        } else {
            addLog("ğŸ’€ çŒœæ‹³ç¬¬ä¸€è½®å°±è¾“äº†ï¼Œè¿™å°±æ˜¯è¿æ°”å•Šã€‚");
        }
        state.jankenEvent = false;
        updateUI();
    }

    // --- ç§»ç±ä¸é™æ ¼é€»è¾‘ ---
    function triggerShuffle() {
        const p = state.player;
        const rand = Math.random();
        if(rand < 0.5) {
            p.status = "ç ”ç©¶ç”Ÿ";
            p.stats.guts -= 30;
            addLog("âš ï¸ã€é™æ ¼é€šçŸ¥ã€‘ç”±äºè¡¨ç°ä¸ä½³ï¼Œä½ è¢«é™æ ¼ä¸ºç ”ç©¶ç”Ÿã€‚è¯·é‡æ–°å¼€å§‹ã€‚", "#c62828");
        } else {
            p.team = "JKT48 (é›…åŠ è¾¾)";
            p.stats.love += 40;
            addLog("âœˆï¸ã€æµ·å¤–ç§»ç±ã€‘ä½ è¢«æ´¾å¾€ JKT48 æ”¯æ´ã€‚è™½ç„¶è¾›è‹¦ï¼Œä½†è¿è¥éå¸¸å…³æ³¨ä½ ï¼", "#00bcd4");
        }
    }

    // --- ç•Œé¢æ›´æ–° ---
    function updateUI() {
        const p = state.player;
        document.getElementById('game-info').innerText = `ç¬¬ ${state.time.year} å¹´ Â· Q${state.time.quarter} | èº«ä»½: ${p.status}`;
        document.getElementById('acts').innerText = state.acts;
        document.getElementById('janken-btn').style.display = state.jankenEvent ? 'block' : 'none';
        document.getElementById('team-info').innerHTML = `<span style="color:var(--akb-pink)">${p.team}</span> / ${p.rank}`;

        const board = document.getElementById('status-board');
        board.innerHTML = `
            ${renderStat("é¢œå€¼", p.stats.visual)}
            ${renderStat("è¡¨ç°", p.stats.perf)}
            ${renderStat("äººæ°”", p.stats.popularity, 5000)}
            ${renderStat("æ–—å¿—", p.stats.guts, 100)}
            ${renderStat("å¿ƒæƒ…", p.stats.mood, 100)}
            <div class="status-card"><span class="status-label">è¿è¥çˆ±</span><span class="status-value">${p.stats.love}</span></div>
        `;

        const bondBoard = document.getElementById('bond-list');
        bondBoard.innerHTML = state.bonds.map(b => `
            <div class="member-item"><strong>${b.name}</strong> (${b.type})<br>ç‰µç»Š: ${b.value}</div>
        `).join('');

        if(p.isGraduated) document.querySelectorAll('button').forEach(b => b.disabled = true);
    }

    function renderStat(l, v, m=100) {
        return `<div class="status-card"><span class="status-label">${l}</span><span class="status-value">${Math.floor(v)}</span></div>`;
    }

    function addLog(msg, color="#00ff41") {
        const log = document.getElementById('log-display');
        const entry = document.createElement('div');
        entry.className = 'log-entry';
        entry.style.color = color;
        entry.innerHTML = `> [${state.time.year}.${state.time.quarter}] ${msg}`;
        log.prepend(entry);
    }

    function requestGraduation() {
        if(confirm("ä½ ç¡®å®šè¦å‘è¡¨å’ä¸šå£°æ˜å—ï¼Ÿè¿™å°†ç»“æŸä½ çš„å¶åƒç”Ÿæ¶¯ã€‚")) {
            state.player.isGraduated = true;
            addLog("ğŸŒ¸ ã€æ¯•ä¸šã€‘è°¢è°¢å¤§å®¶ä¸€ç›´ä»¥æ¥çš„æ”¯æŒï¼è¿™æ˜¯æœ€åçš„ä¸€é¦–æ­Œæ›²â€”â€”", "#fff");
            updateUI();
        }
    }

    init();
</script>
</body>
</html>